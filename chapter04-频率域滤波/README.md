# chapter04-频率域滤波

**关键**：

1）关注基本原理和数字图像处理之间的关系；

2）图像特征与用于表达这些特征的数学工具之间的联系。

**Q**：为什么要学习**频率域滤波**？也就是说学习**频率域滤波**有什么用？

**A**：。

## 4.1 背景

### 4.1.1 傅里叶级数和变换简史

**Q**：什么叫傅里叶级数？

**A**：**任何周期函数**都可以表示为**不同频率的正弦和/或余弦之和的形式**，**只要它是周期的**，并且满足某些适度的数学条件，都可以用这样的和来表示。

**Q**：傅里叶级数或变换**最重要的特征**是什么？

**A**：用傅里叶级数或变换表示的函数特征完全可以通过傅里叶反变换来重建，且不会丢失任何信息。这是这种表示方法的最重要特征之一，因为它可以使我们工作于“傅里叶域”，而且在返回到函数的原始域时不会丢失任何信息。

**Q**：傅里叶技术和图像处理算法的关系是什么？

**A**：傅里叶技术为研究和实现主要的图像处理算法提供了有意义且实用的方法。

Q：傅里叶变换的**物理含义**？

A：

1）傅里叶变换是从空间域到频率域的唯一途径；

2）傅里叶变换有明确的物理意义：**任何时域连续的复杂波形**，通过傅里叶变换，都可以变成一系列简单谐波之和；

3）傅里叶变换具有全局性（例：不能去掉特定空间域的噪声，解决方案是窗口傅里叶变换（STFT）；

4）傅里叶变换在频率域中具有实部和虚部；

5）傅里叶变换在频域中通过实部和虚部的组合有功率谱和相位谱（后面会讲如何分析，进行傅里叶变换的目的是为了改善图像）。

系统

线性系统

线性系统移不变性

Q:**正交变换的关键**是什么？

A：找到正交矩阵。

Q：后面讲的傅里叶变换、小波变换等的本质是什么？

A：找正交矩阵。

Q：为什么引入酉变换（unitary transform)的概念？

A：**酉变换是正交变换的一般推广**。由于傅里叶变换是基于复数的，需要用到共轭求逆，将复数矩阵转换为实数矩阵。

**结论**：酉变换变换前后的均值和方差都和变换举证有关系。

#### 4.1.2 关于本章中的例子

本章的例子主要讲傅里叶变换对图像增强的作用，在第5、8、10和11章，将介绍傅里叶变换的其他应用。

### 4.2 基本概念

#### 4.2.1 复数

本小节讲了复数、实数、虚数、实部、虚部、共轭、复平面、实轴、虚轴、极坐标、欧拉公式和复函数等基本概念。

#### 4.2.2 傅里叶级数

**傅里叶级数**：具有周期T的连续变量t的周期函数f(t)可描述为乘以适当系数的正弦和余弦之和。傅里叶级数具体形式见式（4.2-6）。

#### 4.2.3 冲激及其取样特性

**Q**：冲激以及取样特性的地位？

**A**：**线性系统**和**傅里叶变换**研究的**核心**是冲激及其取样特性。

本节主要讲了单位冲激的定义、冲激的取样（sifting）特性、冲激可以是连续的或离散的、冲激串。

#### 4.2.4 连续变量函数的傅里叶变换

本节主要讲了傅里叶变换对即傅里叶变换和傅里叶反变换的公式，具体见式（4.2-16）和（4.2-17）。

**结论**：例4.1和例4.2告诉我们，时域周期对应的频域周期呈反比关系。

### 4.2.5 卷积

**卷积定理**：时域卷积对应频率域相乘；时域相乘对应频域卷积。

卷积定理是频率域滤波的基础。

## 4.3 取样和取样函数的傅里叶变换

### 4.3.1 取样

**Q**：为什么需要进行取样（采样）操作？

**A**：自然界中的数据一般是连续的，而计算机只有0或1，是离散的，因而需要将连续的信号进行采样得到离散信号以便于计算机的计算处理。

**Q**：如何将连续函数转换为离散序列？

**A**：通过取样和量化来完成的。

**Q**：如何实现取样？

**A**：利用冲激串去乘以原始信号进行采样，具体见式（4.3-1）。

### 4.3.2 取样函数的傅里叶变换

**Q**：原始函数的傅里叶变换和对原始图像经过采样之后再进行傅里叶变换的关系是什么？

**A**：一图胜千言，见图4.6。将原始函数的傅里叶变换看作是一个副本，那么对原始函数进行采样之后再进行傅里叶变换的结果，就是以这个副本为单位，构成的无限的周期序列，该序列的周期是采样频率的倒数。P.S 取样后的函数不连续，但是其频域上是连续的。

### 4.3.3 取样定理

**Q**：带限函数的定义？

**A**：对于一个时域函数，其频域在有限区间（带宽）之外的频率值为0，则称该函数为带限函数。

**Q**：如何成为带限函数？

**A**：该时域函数在时域上是无限扩展的。

**Q**：采样定理的内容？

**A**：超过函数最高频率的2倍进行采样，能够根据采样得到的数据恢复得到原始的函数。

**Q**：重建滤波器的定义？

**A**：如果一个滤波器是从函数的取样来恢复（重建）原始函数的，则该滤波器称为重建滤波器。

### 4.3.4 混淆

Q：混淆的概念？

A：由函数欠采样得到效果叫做频率混淆，简称混淆，见图4.9。

**结论**：书中证明了没有有线持续时间的函数是带限的。反过来，带限函数一定是在时域中无限扩展的。

**例4.3**：通过这个例子介绍了为什么采样频率要严格大于函数最高频率的2倍，通过也说明了当采样频率低于函数最高频率的2倍时，会照成混淆。

### 4.3.5 由取样后的数据重建（复原）函数

**核心**：由采样后的数据重建（复原）函数的核心是**卷积定理**。

**结论**：样本点之间的值是由sinc函数的和形成的内插值。

**实现**：如果根据式（4.3-12），样本间的内插有无限多项。因而在实际中我们必须要找到一种样本间内插有限的近似方法，常用的内插方法有最近邻法、双线性法和双三次内插法。在4.5.4节中将讨论图像内插的效果。

## 4.4 单变量的离散傅里叶变换（DFT）

### 4.4.1 由取样后的函数的连续变换得到DFT

**适用场景**：离散傅里叶变换对适用于任何均匀取样的有限离散样本集。

**公式**：本节的关键是DFT公式，即公式（4.4-6）和（4.4-7）。

**性质**：离散傅里叶变换和反变换都是无限周期的，具体见式（4.4-7）和（4.4-8）。

### 4.4.2 取样和频率间隔间的关系

**结论**：DFT的频率分辨率取决于连续函数被取样的持续时间，并且DFT跨越的频率范围取决于取样间隔，具体见式（4.4-12）和（4.4-13）。

**例4.4 计算DFT的机理**：计算`F(u)`的每一项时用到了`f(x)`的所有值，反之一样。

## 4.5 两个变量的函数的扩展

本节是将4.2节到4.4节介绍的概念扩展到2个变量的情形。

### 4.5.1 二维冲激及其取样特性

一维冲激搞明白了，二维冲激就非常容易理解了。

### 4.5.2 二维连续傅里叶变换对

**公式**：二维连续傅里叶变换对见公式（4.5-7）和（4.5-8）。

**例4.5 得到一个简单函数的二维傅里叶变换**：和例4.1一维的情况相对应。

### 4.5.3 二维取样和二维取样定理

**小结**：本节将一维取样和一维取样定理，扩展得到二维冲激串、二维带限函数、二维采样定理、二维混淆。

**二维采样定理**：如果一个二维带限连续函数在2个方向上以大于函数的最高频率2倍的采样频率进行采样获得样本表示，则不会造成信息丢失。

### 4.5.4 图像中的混淆

**从一维混淆展开**

**例4.6 图像中的混淆**：

Q：当棋盘方格的大小小于一个摄像机像素时会发生什么？

A：严重的混淆或令人完全误解的结果。 

Q：如何降低混淆的影响？

A：通过稍微散焦被数字化的场景来削弱高频成分。

**图像内插和重取样**

放大可视为过取样，缩小则可视为欠取样。

**例4.7 重取样后的图像中的混淆的说明**：为减小混淆，最好在缩小图像之前稍微模糊一下图像。

**例4.8 图像缩小中锯齿现象的说明**：在缩小图像之前使用5*5的均值滤波可以减少锯齿。

**例4.9 图像放大中锯齿现象的说明**：使用双线性内插法可以使得图像边缘平滑。

### 4.5.5 二维离散傅里叶变换及其反变换

**公式**：二维离散傅里叶变换对（DFT）见式（4.5-15）和（4.5-16）。

**重要性**：本章的其余部分以这两个公式的特性及它们在频域图像滤波的应用为基础。

### 4.6.5 傅里叶谱和相角

**结论**：由式（4.6-21）可知，直流项决定图像的评价灰度，因此将其置0会把输出图像的平均灰度减小为0。

### 4.7.3 频率域滤波步骤小结

频率域滤波流程示意图如下所示。具体步骤见书本。

![](..\picture\频率域滤波流程图.png)

